
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://ferdinand026.github.io/documentation-zh/en/using_javatron/toolkit/">
      
      
        <link rel="prev" href="../metrics/">
      
      
        <link rel="next" href="../../api/http/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.8">
    
    
      
        <title>Node Maintenance Tool - Java Tron</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.8608ea7d.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#java-tron-node-maintenance-tool-toolkit" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../../../zh/" title="Java Tron" class="md-header__button md-logo" aria-label="Java Tron" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Java Tron
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Node Maintenance Tool
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
      <div class="md-header__option">
  <div class="md-select">
    
    <button class="md-header__button md-icon" aria-label="选择当前语言">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.5 17.5 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2zm-2.62 7 1.62-4.33L19.12 17z"/></svg>
    </button>
    <div class="md-select__inner">
      <ul class="md-select__list">
        
          <li class="md-select__item">
            <a href="./" hreflang="zh" class="md-select__link">
              简体中文
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../../en/using_javatron/toolkit/" hreflang="en" class="md-select__link">
              English
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="标签" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../zh/" class="md-tabs__link">
          
  
  简体中文

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../" class="md-tabs__link">
          
  
  English

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../zh/" title="Java Tron" class="md-nav__button md-logo" aria-label="Java Tron" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Java Tron
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    简体中文
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            简体中文
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../zh/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    主页
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    English
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            English
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Getting Started With java-tron
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Getting Started With java-tron
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting_started/getting_started_with_javatron/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" checked>
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Using java-tron
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Using java-tron
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../installing_javatron/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Deploying
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../backup_restore/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Backup and Restore
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../litefullnode/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lite FullNode
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../private_network/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Private Network
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/event/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Event Subscription
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/database/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Database Configuration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../connecting_to_tron/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Network Connection
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../metrics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Node Monitoring
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Node Maintenance Tool
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Node Maintenance Tool
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#obtain-toolkitjar" class="md-nav__link">
    <span class="md-ellipsis">
      Obtain Toolkit.jar
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#database-partition-tool" class="md-nav__link">
    <span class="md-ellipsis">
      Database Partition Tool
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Database Partition Tool">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#commands-and-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Commands and parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#usage-instructions" class="md-nav__link">
    <span class="md-ellipsis">
      Usage Instructions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Usage Instructions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#stop-fullnode-service" class="md-nav__link">
    <span class="md-ellipsis">
      Stop FullNode Service
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configure-for-database-storage-migration" class="md-nav__link">
    <span class="md-ellipsis">
      Configure For Database Storage Migration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perform-database-migration" class="md-nav__link">
    <span class="md-ellipsis">
      Perform Database Migration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#restart-fullnode-service" class="md-nav__link">
    <span class="md-ellipsis">
      Restart FullNode Service
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lite-fullnode-data-pruning" class="md-nav__link">
    <span class="md-ellipsis">
      Lite Fullnode Data Pruning
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Lite Fullnode Data Pruning">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#command-and-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Command and parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#usage-instructions_1" class="md-nav__link">
    <span class="md-ellipsis">
      Usage Instructions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_4" >
        
          
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/http/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTTP API
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/rpc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    gRPC API
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/json-rpc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    jsonRPC API
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_5" >
        
          
          <label class="md-nav__link" for="__nav_2_5" id="__nav_2_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Core Protocol
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5">
            <span class="md-nav__icon md-icon"></span>
            Core Protocol
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../mechanism-algorithm/dpos/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DPoS
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../mechanism-algorithm/sr/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Super Representative
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../mechanism-algorithm/account/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Account Model
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../mechanism-algorithm/resource/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Resource Model
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contracts/contract/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Smart Contract
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../mechanism-algorithm/system-contracts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    System Contract
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../mechanism-algorithm/dex/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Decentralized Exchange
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../mechanism-algorithm/multi-signatures/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Account Permission Management
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_6" >
        
          
          <label class="md-nav__link" for="__nav_2_6" id="__nav_2_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    For java-tron Developers
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_6">
            <span class="md-nav__icon md-icon"></span>
            For java-tron Developers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/java-tron/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Developer Guide
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_7" >
        
          
          <label class="md-nav__link" for="__nav_2_7" id="__nav_2_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    For Dapp Developers
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_7">
            <span class="md-nav__icon md-icon"></span>
            For Dapp Developers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contracts/tools/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tools
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#obtain-toolkitjar" class="md-nav__link">
    <span class="md-ellipsis">
      Obtain Toolkit.jar
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#database-partition-tool" class="md-nav__link">
    <span class="md-ellipsis">
      Database Partition Tool
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Database Partition Tool">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#commands-and-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Commands and parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#usage-instructions" class="md-nav__link">
    <span class="md-ellipsis">
      Usage Instructions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Usage Instructions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#stop-fullnode-service" class="md-nav__link">
    <span class="md-ellipsis">
      Stop FullNode Service
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configure-for-database-storage-migration" class="md-nav__link">
    <span class="md-ellipsis">
      Configure For Database Storage Migration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perform-database-migration" class="md-nav__link">
    <span class="md-ellipsis">
      Perform Database Migration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#restart-fullnode-service" class="md-nav__link">
    <span class="md-ellipsis">
      Restart FullNode Service
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lite-fullnode-data-pruning" class="md-nav__link">
    <span class="md-ellipsis">
      Lite Fullnode Data Pruning
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Lite Fullnode Data Pruning">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#command-and-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Command and parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#usage-instructions_1" class="md-nav__link">
    <span class="md-ellipsis">
      Usage Instructions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="java-tron-node-maintenance-tool-toolkit">java-tron Node Maintenance Tool - Toolkit<a class="headerlink" href="#java-tron-node-maintenance-tool-toolkit" title="Permanent link">&para;</a></h1>
<p>The Toolkit integrates a series of tools of java-tron, and more functions will be added into it in the future for the convenience of developers. Currently Toolkit includes the following functions:</p>
<ul>
<li><a href="#database-partition-tool">Database Partition Tool</a></li>
<li><a href="#lite-fullnode-data-pruning">Lite Fullnode Data Pruning</a></li>
<li><a href="#data-copy">Data Copy</a></li>
<li><a href="#data-conversion">Data Conversion</a></li>
<li><a href="#leveldb-startup-optimization">LevelDB Startup Optimization</a></li>
</ul>
<p>The following describes the acquisition and use of the Toolkit toolbox in detail.</p>
<h2 id="obtain-toolkitjar">Obtain Toolkit.jar<a class="headerlink" href="#obtain-toolkitjar" title="Permanent link">&para;</a></h2>
<p><code>Toolkit.jar</code> can be obtained from the <a href="https://github.com/tronprotocol/java-tron/releases">released version</a> directly or by compiling the java-tron source code.</p>
<p>Compile the source code:</p>
<ol>
<li>Obtain java-tron source code
   <code>$ git clone https://github.com/tronprotocol/java-tron.git
   $ git checkout -t origin/master</code></li>
<li>Compile</li>
</ol>
<p><code>$ cd java-tron
   $ ./gradlew clean build -x test</code>
    You will find the <code>Toolkit.jar</code> under <code>./java-tron/build/libs/</code> folder if build is successful.</p>
<h2 id="database-partition-tool">Database Partition Tool<a class="headerlink" href="#database-partition-tool" title="Permanent link">&para;</a></h2>
<p>As the data on the chain continues to grow, the pressure on data storage will increase. At present, the FullNode data of the TRON public chain has reached 1T, and the daily data growth is about 1.2G. According to the current data growth rate, the annual growth rate is about 450G. A single disk capacity may be insufficient and need to be replaced by a larger disk. To this end the Toolkit toolbox introduces the database storage partitioning tool. The tool can migrate some databases to other storage disks. When the user encounters insufficient disk space, he only needs to add another disk according to the capacity requirement and does not need to replace the original disk.</p>
<h3 id="commands-and-parameters">Commands and parameters<a class="headerlink" href="#commands-and-parameters" title="Permanent link">&para;</a></h3>
<p>To use the data partition function provided by Toolkit through the <code>db mv</code> command:</p>
<div class="codehilite"><pre><span></span><code><span class="gh">#</span> full command
java -jar Toolkit.jar db mv [-h] [-c=&lt;config&gt;] [-d=&lt;database&gt;]
<span class="gh">#</span> examples
java -jar Toolkit.jar db mv -c main_net_config.conf -d /data/tron/output-directory
</code></pre></div>

<p>Optional command parameters are as follows:</p>
<ul>
<li><code>-c | --config</code>: [ string ] This option is used to specify the FullNode configuration file. If not specified, the default value will be config.conf.</li>
<li><code>-d | --database-directory</code>: [ string ] This option is used to specify the FullNode database directory. If not specified, the default value will be output-directory.</li>
<li><code>-h | --help</code>: [ bool ] This option is used to view help description, default value: false.</li>
</ul>
<h3 id="usage-instructions">Usage Instructions<a class="headerlink" href="#usage-instructions" title="Permanent link">&para;</a></h3>
<p>Follow the following steps to use the database partition tool:</p>
<ol>
<li><a href="#stop-fullnode-service">Stop FullNode service</a></li>
<li><a href="#configure-for-database-storage-migration">Configure for database storage migration</a></li>
<li><a href="#perform-database-migration">Perform database migration</a></li>
<li><a href="#restart-fullnode-service">Restart FullNode service</a></li>
</ol>
<h4 id="stop-fullnode-service">Stop FullNode Service<a class="headerlink" href="#stop-fullnode-service" title="Permanent link">&para;</a></h4>
<p>Use the command kill -15 pid to close FullNode.jar, below is the FullNode process pid lookup command:</p>
<div class="codehilite"><pre><span></span><code>$<span class="w"> </span>ps<span class="w"> </span>-ef<span class="w"> </span><span class="p">|</span>grep<span class="w"> </span>FullNode.jar<span class="w"> </span><span class="p">|</span>grep<span class="w"> </span>-v<span class="w"> </span>grep<span class="w"> </span><span class="p">|</span>awk<span class="w"> </span><span class="s1">&#39;{print $2}&#39;</span><span class="sb">`</span>
</code></pre></div>

<h4 id="configure-for-database-storage-migration">Configure For Database Storage Migration<a class="headerlink" href="#configure-for-database-storage-migration" title="Permanent link">&para;</a></h4>
<p>The configuration of database migration is in the <a href="https://github.com/tronprotocol/tron-deployment/blob/master/main_net_config.conf#L36">storage.properties</a> field in the java-tron node configuration file. The following is an example of migrating only the <code>block</code> and <code>trans</code> databases to illustrate how to migrate some databases to other storage disks:</p>
<div class="codehilite"><pre><span></span><code>storage {
 ......
  properties = [
    {
     name = &quot;block&quot;,
     path = &quot;/data1/tron&quot;,

    },
    {
     name = &quot;trans&quot;,
     path = &quot;/data1/tron&quot;,
   }
  ]
 ......
}
</code></pre></div>

<p><code>name</code> is the database name which you want to migrate, and <code>path</code> is the destination directory for database migration. The tool will migrate the database specified by <code>name</code> to the directory specified by <code>path</code>, and then create a soft link under the original path pointing to <code>path</code> directory. After <code>FullNode</code> starts, it will find the <code>path</code> directory according to the soft link.</p>
<h4 id="perform-database-migration">Perform Database Migration<a class="headerlink" href="#perform-database-migration" title="Permanent link">&para;</a></h4>
<p>When executed, the current migration progress will be shown.</p>
<div class="codehilite"><pre><span></span><code>$<span class="w"> </span>java<span class="w"> </span>-jar<span class="w"> </span>Toolkit.jar<span class="w"> </span>db<span class="w"> </span>mv<span class="w"> </span>-c<span class="w"> </span>main_net_config.conf<span class="w"> </span>-d<span class="w"> </span>/data/tron/output-directory
</code></pre></div>

<h4 id="restart-fullnode-service">Restart FullNode Service<a class="headerlink" href="#restart-fullnode-service" title="Permanent link">&para;</a></h4>
<p>After the migration is complete, restart the java-tron node.</p>
<div class="codehilite"><pre><span></span><code><span class="gh">#</span> FullNode
$ nohup java -Xms9G -Xmx9G -XX:ReservedCodeCacheSize=256m \
                -XX:MetaspaceSize=256m -XX:MaxMetaspaceSize=512m \
                -XX:MaxDirectMemorySize=1G -XX:+PrintGCDetails \
                -XX:+PrintGCDateStamps  -Xloggc:gc.log \
                -XX:+UseConcMarkSweepGC -XX:NewRatio=2 \
                -XX:+CMSScavengeBeforeRemark -XX:+ParallelRefProcEnabled \
                -XX:+HeapDumpOnOutOfMemoryError \
                -XX:+UseCMSInitiatingOccupancyOnly  -XX:CMSInitiatingOccupancyFraction=70 \
                -jar FullNode.jar -c main_net_config.conf &gt;&gt; start.log 2&gt;&amp;1 &amp;

<span class="gh">#</span> Super representative&#39;s FullNode
$ nohup java -Xms9G -Xmx9G -XX:ReservedCodeCacheSize=256m \
               -XX:MetaspaceSize=256m -XX:MaxMetaspaceSize=512m \
               -XX:MaxDirectMemorySize=1G -XX:+PrintGCDetails \
               -XX:+PrintGCDateStamps  -Xloggc:gc.log \
               -XX:+UseConcMarkSweepGC -XX:NewRatio=2 \
               -XX:+CMSScavengeBeforeRemark -XX:+ParallelRefProcEnabled \
               -XX:+HeapDumpOnOutOfMemoryError \
               -XX:+UseCMSInitiatingOccupancyOnly  -XX:CMSInitiatingOccupancyFraction=70 \
               -jar FullNode.jar --witness -c main_net_config.conf &gt;&gt; start.log 2&gt;&amp;1 &amp;
</code></pre></div>

<h2 id="lite-fullnode-data-pruning">Lite Fullnode Data Pruning<a class="headerlink" href="#lite-fullnode-data-pruning" title="Permanent link">&para;</a></h2>
<p>Toolkit provides data pruning tool, which is mainly used for generating or pruning Lite Fullnode data.</p>
<p>The data pruning tool can divide the complete FullNode data into a snapshot dataset (Snapshot dataset) or a historical dataset (History dataset) according to the current <code>latest_block_number</code>, the snapshot dataset is used to start the Lite Fullnode (That is the Lite fullnode database), and the historical dataset is used for historical data query. Lite Fullnode started with a snapshot data set do not support querying historical data prior to the latest block height at the time of pruning. The data pruning tool also provides the function of merging historical data set with snapshot data set. The usage scenarios are as follows:</p>
<ul>
<li>
<p><strong>Convert FullNode data into Lite Fullnode data</strong></p>
<p>The Lite Fullnode starts only based on the snapshot data set, use the data pruning tool to convert the full node data into the snapshot data set, and that will get the Lite Fullnode data</p>
</li>
<li>
<p><strong>Prune Lite Fullnode data regularly</strong></p>
<p>Since the Lite Fullnode saves the same data as the FullNode after startup, although the data volume of the Lite Fullnode is very small at startup, the data expansion rate in the later period is the same as that of the FullNode, so it may be necessary to periodically prune the data. Clipping the Lite Fullnode data is also to use this tool to cut the Lite Fullnode data into snapshot data set, that is, to obtain the Pruned Lite Fullnode data</p>
</li>
<li>
<p><strong>Convert Lite Fullnode data back to FullNode data</strong></p>
<p>Since Lite Fullnode does not support historical data query, if you want to support it, you need to change Lite Fullnode data into FullNode data, then the node will change from Lite Fullnode to FullNode. You can directly download the snapshot of the FullNode database, or you can use the data pruning tool: first, convert the FullNode data into historical data set, and then merge the historical data set and the snapshot data set of the Lite Fullnode to obtain the FullNode data.</p>
</li>
</ul>
<p>Note: Before using this tool for any operation, you need to stop the currently running node first.</p>
<h3 id="command-and-parameters">Command and parameters<a class="headerlink" href="#command-and-parameters" title="Permanent link">&para;</a></h3>
<p>To use the data pruning tool provided by Toolkit through the <code>db lite</code> command:</p>
<div class="codehilite"><pre><span></span><code><span class="err">#</span><span class="w"> </span><span class="nx">full</span><span class="w"> </span><span class="nx">command</span>
<span class="w">  </span><span class="nx">java</span><span class="w"> </span><span class="o">-</span><span class="nx">jar</span><span class="w"> </span><span class="nx">Toolkit</span><span class="p">.</span><span class="nx">jar</span><span class="w"> </span><span class="nx">db</span><span class="w"> </span><span class="nx">lite</span><span class="w"> </span><span class="p">[</span><span class="o">-</span><span class="nx">h</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="nx">ds</span><span class="p">=&lt;</span><span class="nx">datasetPath</span><span class="p">&gt;</span><span class="w"> </span><span class="o">-</span><span class="kd">fn</span><span class="p">=&lt;</span><span class="nx">fnDataPath</span><span class="p">&gt;</span><span class="w"> </span><span class="p">[</span><span class="o">-</span><span class="nx">o</span><span class="p">=&lt;</span><span class="nx">operate</span><span class="p">&gt;]</span><span class="w"> </span><span class="p">[</span><span class="o">-</span><span class="nx">t</span><span class="p">=&lt;</span><span class="k">type</span><span class="p">&gt;]</span>
<span class="err">#</span><span class="w"> </span><span class="nx">examples</span>
<span class="w">  </span><span class="err">#</span><span class="nx">split</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="nx">get</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">snapshot</span><span class="w"> </span><span class="nx">dataset</span>
<span class="w">  </span><span class="nx">java</span><span class="w"> </span><span class="o">-</span><span class="nx">jar</span><span class="w"> </span><span class="nx">Toolkit</span><span class="p">.</span><span class="nx">jar</span><span class="w"> </span><span class="nx">db</span><span class="w"> </span><span class="nx">lite</span><span class="w"> </span><span class="o">-</span><span class="nx">o</span><span class="w"> </span><span class="nx">split</span><span class="w"> </span><span class="o">-</span><span class="nx">t</span><span class="w"> </span><span class="nx">snapshot</span><span class="w"> </span><span class="o">--</span><span class="kd">fn</span><span class="o">-</span><span class="nx">data</span><span class="o">-</span><span class="nx">path</span><span class="w"> </span><span class="nx">output</span><span class="o">-</span><span class="nx">directory</span><span class="o">/</span><span class="nx">database</span><span class="w"> </span><span class="o">--</span><span class="nx">dataset</span><span class="o">-</span><span class="nx">path</span><span class="w"> </span><span class="o">/</span><span class="nx">tmp</span>
<span class="w">  </span><span class="err">#</span><span class="nx">split</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="nx">get</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">history</span><span class="w"> </span><span class="nx">dataset</span>
<span class="w">  </span><span class="nx">java</span><span class="w"> </span><span class="o">-</span><span class="nx">jar</span><span class="w"> </span><span class="nx">Toolkit</span><span class="p">.</span><span class="nx">jar</span><span class="w"> </span><span class="nx">db</span><span class="w"> </span><span class="nx">lite</span><span class="w"> </span><span class="o">-</span><span class="nx">o</span><span class="w"> </span><span class="nx">split</span><span class="w"> </span><span class="o">-</span><span class="nx">t</span><span class="w"> </span><span class="nx">history</span><span class="w"> </span><span class="o">--</span><span class="kd">fn</span><span class="o">-</span><span class="nx">data</span><span class="o">-</span><span class="nx">path</span><span class="w"> </span><span class="nx">output</span><span class="o">-</span><span class="nx">directory</span><span class="o">/</span><span class="nx">database</span><span class="w"> </span><span class="o">--</span><span class="nx">dataset</span><span class="o">-</span><span class="nx">path</span><span class="w"> </span><span class="o">/</span><span class="nx">tmp</span>
<span class="w">  </span><span class="err">#</span><span class="nx">merge</span><span class="w"> </span><span class="nx">history</span><span class="w"> </span><span class="nx">dataset</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="nx">snapshot</span><span class="w"> </span><span class="nx">dataset</span>
<span class="w">  </span><span class="nx">java</span><span class="w"> </span><span class="o">-</span><span class="nx">jar</span><span class="w"> </span><span class="nx">Toolkit</span><span class="p">.</span><span class="nx">jar</span><span class="w"> </span><span class="nx">db</span><span class="w"> </span><span class="nx">lite</span><span class="w"> </span><span class="o">-</span><span class="nx">o</span><span class="w"> </span><span class="nx">merge</span><span class="w"> </span><span class="o">--</span><span class="kd">fn</span><span class="o">-</span><span class="nx">data</span><span class="o">-</span><span class="nx">path</span><span class="w"> </span><span class="o">/</span><span class="nx">tmp</span><span class="o">/</span><span class="nx">snapshot</span><span class="w"> </span><span class="o">--</span><span class="nx">dataset</span><span class="o">-</span><span class="nx">path</span><span class="w"> </span><span class="o">/</span><span class="nx">tmp</span><span class="o">/</span><span class="nx">history</span>
</code></pre></div>

<p>Optional command parameters are as follows:</p>
<ul>
<li><code>--operation | -o</code>: [ split | merge ], this parameter specifies the operation as either to split or to merge, default is split.</li>
<li><code>--type | -t</code>: [ snapshot | history ], this parameter is used only when the operation is <code>split</code>. <code>snapshot</code> means clip to Snapshot Dataset and <code>history</code> means clip to History Dataset. Default is <code>snapshot</code>.</li>
<li><code>--fn-data-path | -fn</code>: The database path to be split or merged. When the operation type is <code>split</code>, <code>fn-data-path</code> is used to indicate the directory of the data to be pruned; when the operation type is <code>merge</code>, <code>fn-data-path</code> indicates the database directory of the Lite Fullnode or the directory of the snapshot dataset.</li>
<li><code>--dataset-path | -ds</code>: When operation is <code>split</code>, dataset-path is the path that store the snapshot or history, when operation is <code>merge</code>, dataset-path is the history data path.</li>
</ul>
<h3 id="usage-instructions_1">Usage Instructions<a class="headerlink" href="#usage-instructions_1" title="Permanent link">&para;</a></h3>
<p>The node database is stored in the <code>output-directory/database</code> directory by default. The examples in this chapter will be explained with the default database directory.</p>
<p>The following three examples illustrate how to use the data pruning tool:</p>
<ul>
<li>
<p><strong>Split and get a <code>Snapshot Dataset</code></strong></p>
<p>This function can split FullNode data into Lite Fullnode data, and can also be used to regularly trim Lite Fullnode data. The steps are as follows:</p>
<p>First, stop the FullNode and execute:</p>
<p>```shell</p>
<h1 id="just-for-simplify-save-the-snapshot-into-tmp-directory">just for simplify, save the snapshot into /tmp directory<a class="headerlink" href="#just-for-simplify-save-the-snapshot-into-tmp-directory" title="Permanent link">&para;</a></h1>
<p>java -jar Toolkit.jar db lite -o split -t snapshot --fn-data-path output-directory/database --dataset-path /tmp
```</p>
<ul>
<li>--fn-data-path： The data directory to be trimmed, that is, the node data directory</li>
<li>--dataset-path： The directory where the output snapshot dataset is stored</li>
</ul>
<p>After the command is executed, a <code>snapshot</code> directory will be generated in <code>/tmp</code>, the data in this directory is the Lite Fullnode data, then rename the directory from <code>snapshot</code> to <code>database</code> (the default value of the storage.db.directory is <code>database</code>, make sure rename the snapshot directory to the specified value) and copy the <code>database</code> directory  to the Lite Fullnode database directory to finish the splitting. Finally start the Lite Fullnode. </p>
</li>
<li>
<p><strong>Split and get a <code>History Dataset</code></strong></p>
<p>The command to split the historical data set is as follows:</p>
<p>```shell</p>
<h1 id="just-for-simplify-save-the-history-into-tmp-directory">just for simplify, save the history into <code>/tmp</code> directory,<a class="headerlink" href="#just-for-simplify-save-the-history-into-tmp-directory" title="Permanent link">&para;</a></h1>
<p>java -jar Toolkit.jar db lite -o split -t history --fn-data-path output-directory/database --dataset-path /tmp
```</p>
<ul>
<li>--fn-data-path： FullNode data directory</li>
<li>--dataset-path： The directory where the output historical dataset is stored</li>
</ul>
<p>After the command is executed, the <code>history</code> directory will be generated under the <code>/tmp</code> directory, and the data in it is the historical dataset.</p>
</li>
<li>
<p><strong>Merge <code>History Dataset</code> and <code>Snapshot Dataset</code></strong></p>
<p>Both <code>History Dataset</code> and <code>Snapshot Dataset</code> have an <code>info.properties</code> file to identify the block height when they are split. Make sure that the <code>split_block_num</code> in <code>History Dataset</code> is not less than the corresponding value in the <code>Snapshot Dataset</code>. After the historical dataset is merged with the snapshot dataset through the merge operation, the Lite Fullnode will become a real FullNode.</p>
<p>The command to merge the historical dataset and the snapshot dataset is as follows:</p>
<p>```shell</p>
<h1 id="just-for-simplify-assume-history-dataset-is-locate-in-tmp">just for simplify, assume <code>History dataset</code> is locate in /tmp<a class="headerlink" href="#just-for-simplify-assume-history-dataset-is-locate-in-tmp" title="Permanent link">&para;</a></h1>
<p>java -jar Toolkit.jar db lite -o merge --fn-data-path /tmp/snapshot --dataset-path /tmp/history
```</p>
<ul>
<li>--fn-data-path： snapshot dataset directory</li>
<li>--dataset-path： history dataset directory</li>
</ul>
<p>After the command is executed, the merged data will overwrite the directory where the snapshot data set is located, that is, the directory specified by <code>--fn-data-path</code>, copy the merged data to the node database directory, and the Lite Fullnode becomes a FullNode.</p>
</li>
</ul>
<h2 id="data-copy">Data Copy<a class="headerlink" href="#data-copy" title="Permanent link">&para;</a></h2>
<p>The node database is large, and the database copy operation is time-consuming. The Toolkit provides a fast database copy function, which can quickly copy the LevelDB or RocksDB database in the same file system by creating a hard link.</p>
<h3 id="command-and-parameters_1">Command and parameters<a class="headerlink" href="#command-and-parameters_1" title="Permanent link">&para;</a></h3>
<p>To use the data copy function provided by Toolkit through <code>db copy</code> :</p>
<div class="codehilite"><pre><span></span><code># full command
  java -jar Toolkit.jar db cp [-h] &lt;src&gt; &lt;dest&gt;
# examples
  java -jar Toolkit.jar db cp  output-directory/database /tmp/database
</code></pre></div>

<p>Optional command parameters are as follows:</p>
<ul>
<li><code>&lt;src&gt;</code>: Source path for database. Default: output-directory/database</li>
<li><code>&lt;dest&gt;</code>: Output path for database. Default: output-directory-cp/database</li>
<li><code>-h | --help</code>：[ bool ] provide the help info. Default: false</li>
</ul>
<p>Note: Before using this tool for any operation, you need to stop the currently running node first.</p>
<h2 id="data-conversion">Data Conversion<a class="headerlink" href="#data-conversion" title="Permanent link">&para;</a></h2>
<p>Toolkit supports database data conversion function, which can convert LevelDB data into RocksDB data.</p>
<h3 id="command-and-parameters_2">Command and parameters<a class="headerlink" href="#command-and-parameters_2" title="Permanent link">&para;</a></h3>
<p>To use the data conversion function provided by Toolkit through <code>db convert</code> command:</p>
<div class="codehilite"><pre><span></span><code># full command
  java -jar Toolkit.jar db convert [-h] [--safe] &lt;src&gt; &lt;dest&gt;
# examples
  java -jar Toolkit.jar db convert  output-directory/database /tmp/database
</code></pre></div>

<p>Optional command parameters are as follows:</p>
<ul>
<li><code>&lt;src&gt;</code>:  Input path for leveldb, default: output-directory/database.</li>
<li><code>&lt;dest&gt;</code>: Output path for rocksdb, default: output-directory-dst/database.</li>
<li><code>--safe</code>：In safe mode, read data from leveldb then put into rocksdb, it's a very time-consuming procedure. If not, just change engine.properties from leveldb to rocksdb, rocksdb is compatible with leveldb for the current version. This may not be the case in the future, default: false.</li>
<li><code>-h | --help</code>：[ bool ]  Provide the help info, default: false。</li>
</ul>
<p>Note: Before using this tool for any operation, you need to stop the currently running node first.</p>
<h2 id="leveldb-startup-optimization">LevelDB Startup Optimization<a class="headerlink" href="#leveldb-startup-optimization" title="Permanent link">&para;</a></h2>
<p>with the running of levedb, the manifest file will continue to grow. Excessive manifest file will not only affect the startup speed of the node, moreover, there may be an issue that the service is terminated abnormally due to the continuous growth of memory. To solve this issue, toolkit provides the leveldb startup optimization tool. The tool optimizes the file size of the manifest and the startup process of LevelDB, reduces memory usage, and improves node startup speed.</p>
<h3 id="command-and-parameters_3">Command and parameters<a class="headerlink" href="#command-and-parameters_3" title="Permanent link">&para;</a></h3>
<p>To use the LevelDB startup optimization function provided by Toolkit through <code>db archive</code> command:</p>
<div class="codehilite"><pre><span></span><code># full command
   java -jar Toolkit.jar db archive [-h] [-b=&lt;maxBatchSize&gt;] [-d=&lt;databaseDirectory&gt;] [-m=&lt;maxManifestSize&gt;]
# examples
   #1. use default settings
   java -jar Toolkit.jar db archive 
   #2. specify the database directory as /tmp/db/database
   java -jar Toolkit.jar db archive -d /tmp/db/database 
   #3. specify the batch size to 64000 when optimizing manifest
   java -jar Toolkit.jar db archive -b 64000
   #4. specify optimization only when Manifest exceeds 128M
   java -jar Toolkit.jar db archive -m 128 
</code></pre></div>

<p>Optional command parameters are as follows:</p>
<ul>
<li><code>-b | --batch-size</code>: Specify the batch manifest size, default: 80000.</li>
<li><code>-d | --database-directory</code>: Specify the database directory to be processed, default: output-directory/database.</li>
<li><code>-m | --manifest-size</code>: Specify the minimum required manifest file size, unit: M, default: 0.</li>
<li><code>-h | --help</code>：[ bool ]  Provide the help info, default: false.</li>
</ul>
<p>Note: Before using this tool for any operation, you need to stop the currently running node first.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tracing", "navigation.expand", "navigation.tabs"], "search": "../../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.c8b220af.min.js"></script>
      
    
  </body>
</html>